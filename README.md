# å…¨è‡ªåŠ¨AIå°è¯´ç”Ÿæˆç³»ç»Ÿ

åŸºäº [Anthropic é•¿è¿è¡Œä»£ç†æœ€ä½³å®è·µ](https://www.anthropic.com/engineering/effective-harnesses-for-long-running-agents) æ„å»ºçš„å…¨è‡ªåŠ¨AIå°è¯´ç”Ÿæˆç³»ç»Ÿã€‚

## æ ¸å¿ƒæ¦‚å¿µ

æœ¬ç³»ç»Ÿå€Ÿé‰´äº† Anthropic æ–‡ç« ä¸­æå‡ºçš„**é•¿è¿è¡Œä»£ç†**è§£å†³æ–¹æ¡ˆï¼š

### 1. Initializer Agentï¼ˆåˆå§‹åŒ–ä»£ç†ï¼‰
- é¦–æ¬¡è¿è¡Œæ—¶è®¾ç½®å®Œæ•´çš„å°è¯´é¡¹ç›®ç¯å¢ƒ
- åˆ›å»ºè¯¦ç»†çš„å°è¯´å¤§çº²
- è®¾è®¡å®Œæ•´çš„è§’è‰²è®¾å®š
- è§„åˆ’ç« èŠ‚ç»“æ„ï¼ˆFeature Listï¼‰
- è®¾å®šä¸–ç•Œè§‚å’Œå†™ä½œé£æ ¼æŒ‡å—

### 2. Writer Agentï¼ˆå†™ä½œä»£ç†ï¼‰
- æ¯æ¬¡ä¼šè¯è¿›è¡Œå¢é‡å¼è¿›å±•
- ä¸€æ¬¡åªä¸“æ³¨äºä¸€ä¸ªç« èŠ‚
- é˜…è¯»è¿›åº¦æ–‡ä»¶äº†è§£å·²å®Œæˆå†…å®¹
- åˆ›ä½œå®Œæˆåæ›´æ–°è¿›åº¦æ–‡ä»¶
- ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶

### 3. Reviewer Agentï¼ˆå®¡æŸ¥ä»£ç†ï¼‰
- è¯„ä¼°ç« èŠ‚è´¨é‡çš„å¤šä¸ªç»´åº¦
- æä¾›å…·ä½“çš„ä¿®æ”¹å»ºè®®
- ç¡®ä¿è´¨é‡è¾¾æ ‡åæ‰æ ‡è®°å®Œæˆ

### 4. è¿›åº¦ç®¡ç†ç³»ç»Ÿ
- **novel-progress.txt**: è®°å½•æ•´ä½“è¿›åº¦å’Œæ¯ä¸ªç« èŠ‚çš„çŠ¶æ€
- **chapter-list.json**: ç« èŠ‚åˆ—è¡¨ï¼ˆå¯¹åº”æ–‡ç« ä¸­çš„ feature listï¼‰
- **characters.json**: è§’è‰²è®¾å®š
- **outline.md**: å°è¯´å¤§çº²

## ç³»ç»Ÿæ¶æ„

```
novel_generator/
â”œâ”€â”€ agents/                    # ä»£ç†æ¨¡å—
â”‚   â”œâ”€â”€ initializer_agent.py  # åˆå§‹åŒ–ä»£ç†
â”‚   â”œâ”€â”€ writer_agent.py       # å†™ä½œä»£ç†
â”‚   â””â”€â”€ reviewer_agent.py     # å®¡æŸ¥ä»£ç†
â”œâ”€â”€ core/                      # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ novel_generator.py    # ä¸»æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ progress_manager.py   # è¿›åº¦ç®¡ç†
â”‚   â”œâ”€â”€ chapter_manager.py    # ç« èŠ‚ç®¡ç†
â”‚   â””â”€â”€ character_manager.py  # è§’è‰²ç®¡ç†
â”œâ”€â”€ config/                    # é…ç½®æ¨¡å—
â”‚   â””â”€â”€ settings.py           # é…ç½®è®¾ç½®
â”œâ”€â”€ examples/                  # ç¤ºä¾‹
â”‚   â””â”€â”€ example_config.json   # ç¤ºä¾‹é…ç½®
â”œâ”€â”€ app.py                     # Web UIç•Œé¢ï¼ˆStreamlitï¼‰
â”œâ”€â”€ main.py                    # å‘½ä»¤è¡Œå…¥å£
â””â”€â”€ README.md                  # æœ¬æ–‡ä»¶
```

## é¡¹ç›®ç»“æ„

æ¯ä¸ªå°è¯´é¡¹ç›®ä¼šç”Ÿæˆä»¥ä¸‹ç»“æ„ï¼š

```
novels/{title}/
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ outline.md                 # å°è¯´å¤§çº²
â”œâ”€â”€ characters.json            # è§’è‰²è®¾å®š
â”œâ”€â”€ chapter-list.json          # ç« èŠ‚åˆ—è¡¨ï¼ˆFeature Listï¼‰
â”œâ”€â”€ style-guide.md            # å†™ä½œé£æ ¼æŒ‡å—
â”œâ”€â”€ novel-progress.txt        # è¿›åº¦è·Ÿè¸ª
â”œâ”€â”€ generation-report.txt     # ç”ŸæˆæŠ¥å‘Š
â”œâ”€â”€ chapters/                 # ç« èŠ‚å†…å®¹
â”‚   â”œâ”€â”€ chapter-001.md
â”‚   â”œâ”€â”€ chapter-002.md
â”‚   â””â”€â”€ ...
â””â”€â”€ reviews/                  # å®¡æŸ¥æŠ¥å‘Š
    â”œâ”€â”€ review-001.md
    â”œâ”€â”€ review-002.md
    â””â”€â”€ ...
```

## å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone <repository-url>
cd novel_generator

# å®‰è£…ä¾èµ–ï¼ˆå®é™…ä½¿ç”¨æ—¶éœ€è¦å®‰è£…LLMå®¢æˆ·ç«¯ï¼‰
pip install -r requirements.txt
```

## ä½¿ç”¨æ–¹æ³•

### 1. Web UI ç•Œé¢ï¼ˆæ¨èï¼‰

å¯åŠ¨ç°ä»£åŒ–çš„ Web ç•Œé¢ï¼š

```bash
streamlit run app.py
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://localhost:8501

åŠŸèƒ½åŒ…æ‹¬ï¼š
- ğŸ“š **é¦–é¡µ** - é¡¹ç›®æ¦‚è§ˆå’Œå¿«é€Ÿå¯¼èˆª
- â• **åˆ›å»ºæ–°é¡¹ç›®** - å¡«å†™å°è¯´é…ç½®å¹¶åˆå§‹åŒ–
- âœï¸ **å†™ä½œæ§åˆ¶** - å¯åŠ¨å†™ä½œã€è´¨é‡å®¡æŸ¥ã€åˆå¹¶å¯¼å‡º
- ğŸ“Š **è¿›åº¦ç›‘æ§** - å®æ—¶æŸ¥çœ‹é¡¹ç›®è¿›åº¦å’Œç« èŠ‚çŠ¶æ€
- ğŸ“– **æŸ¥çœ‹ç« èŠ‚** - é˜…è¯»å·²ç”Ÿæˆç« èŠ‚å¹¶ä¸‹è½½
- âš™ï¸ **ç³»ç»Ÿè®¾ç½®** - é…ç½®ç•Œé¢ä¸»é¢˜ã€AIæ¨¡å‹ç­‰

### 2. äº¤äº’å¼æ¨¡å¼

```bash
python main.py --interactive
```

æŒ‰ç…§æç¤ºè¾“å…¥å°è¯´æ ‡é¢˜ã€ç±»å‹ã€ç« èŠ‚æ•°ç­‰ä¿¡æ¯ã€‚

### 3. ä½¿ç”¨é…ç½®æ–‡ä»¶

åˆ›å»ºé…ç½®æ–‡ä»¶ `my_novel.json`ï¼š

```json
{
  "title": "æˆ‘çš„ç§‘å¹»å°è¯´",
  "genre": "ç§‘å¹»",
  "target_chapters": 10,
  "words_per_chapter": 3000,
  "description": "å…³äºäººå·¥æ™ºèƒ½è§‰é†’çš„æ•…äº‹"
}
```

è¿è¡Œï¼š

```bash
python main.py --config my_novel.json
```

### 4. å‘½ä»¤è¡Œå‚æ•°

```bash
python main.py --title "æˆ‘çš„ç§‘å¹»å°è¯´" --genre "ç§‘å¹»" --chapters 10 --words 3000
```

### 5. æŸ¥çœ‹è¿›åº¦

```bash
python main.py --progress novels/my_novel
```

## é…ç½®é€‰é¡¹

| é€‰é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| title | string | å¿…å¡« | å°è¯´æ ‡é¢˜ |
| genre | string | general | å°è¯´ç±»å‹ |
| target_chapters | int | 10 | ç›®æ ‡ç« èŠ‚æ•° |
| words_per_chapter | int | 3000 | æ¯ç« å­—æ•° |
| description | string | "" | æ•…äº‹ç®€ä»‹ |
| writing_style | string | descriptive | å†™ä½œé£æ ¼ |
| tone | string | neutral | åŸºè°ƒ |
| enable_self_review | bool | true | å¯ç”¨è‡ªæˆ‘å®¡æŸ¥ |
| min_chapter_quality_score | float | 7.0 | æœ€ä½è´¨é‡åˆ†æ•° |
| max_revision_attempts | int | 3 | æœ€å¤§ä¿®æ”¹æ¬¡æ•° |

## å·¥ä½œæµç¨‹

### é˜¶æ®µ1: åˆå§‹åŒ–

Initializer Agent æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š

1. **åˆ›å»ºå¤§çº²** - åŸºäºç”¨æˆ·éœ€æ±‚ç”Ÿæˆè¯¦ç»†çš„æ•…äº‹å¤§çº²
2. **è®¾è®¡è§’è‰²** - åˆ›å»ºä¸»è§’ã€åæ´¾å’Œé…è§’çš„å®Œæ•´è®¾å®š
3. **è§„åˆ’ç« èŠ‚** - ä¸ºæ¯ä¸ªç« èŠ‚åˆ¶å®šè¯¦ç»†çš„è§„æ ¼ï¼ˆFeature Listï¼‰
4. **è®¾å®šé£æ ¼** - åˆ›å»ºå†™ä½œé£æ ¼æŒ‡å—
5. **åˆå§‹åŒ–è¿›åº¦** - åˆ›å»ºè¿›åº¦è·Ÿè¸ªæ–‡ä»¶

### é˜¶æ®µ2: å†™ä½œ

Writer Agent å¾ªç¯æ‰§è¡Œï¼š

1. **è¯»å–è¿›åº¦** - äº†è§£å·²å®Œæˆçš„å†…å®¹
2. **é€‰æ‹©ç« èŠ‚** - è·å–ä¸‹ä¸€ä¸ªå¾…å®Œæˆçš„ç« èŠ‚
3. **åŠ è½½ä¸Šä¸‹æ–‡** - é˜…è¯»å¤§çº²ã€è§’è‰²è®¾å®šå’Œå‰ä¸€ç« èŠ‚
4. **åˆ›ä½œå†…å®¹** - ç”Ÿæˆç« èŠ‚å†…å®¹
5. **è‡ªæˆ‘å®¡æŸ¥** - è¯„ä¼°å¹¶ä¿®æ”¹å†…å®¹
6. **ä¿å­˜ç« èŠ‚** - å°†å†…å®¹å†™å…¥æ–‡ä»¶
7. **æ›´æ–°è¿›åº¦** - æ›´æ–°è¿›åº¦æ–‡ä»¶
8. **Gitæäº¤** - æäº¤æ›´æ”¹

### é˜¶æ®µ3: å®¡æŸ¥

Reviewer Agent è¯„ä¼°æ¯ä¸ªç« èŠ‚ï¼š

- **æƒ…èŠ‚è¿è´¯æ€§** - æ˜¯å¦ä¸å¤§çº²ä¸€è‡´
- **è§’è‰²ä¸€è‡´æ€§** - è§’è‰²è¡Œä¸ºæ˜¯å¦ç¬¦åˆè®¾å®š
- **å†™ä½œè´¨é‡** - æ–‡ç¬”ã€æå†™ã€å¯¹è¯
- **å¸å¼•åŠ›** - æ˜¯å¦å¼•äººå…¥èƒœ
- **æŠ€æœ¯å‡†ç¡®æ€§** - è¯­æ³•ã€æ ‡ç‚¹ã€æ ¼å¼

### é˜¶æ®µ4: åˆå¹¶

å°†æ‰€æœ‰ç« èŠ‚åˆå¹¶ä¸ºå®Œæ•´çš„å°è¯´æ–‡ä»¶ã€‚

## æ ¸å¿ƒä¼˜åŠ¿

### 1. å¢é‡å¼è¿›å±•

åŸºäº Anthropic æ–‡ç« çš„æ ¸å¿ƒæ´å¯Ÿï¼š
- æ¯æ¬¡ä¼šè¯åªå¤„ç†ä¸€ä¸ªç« èŠ‚
- é¿å…å°è¯•ä¸€æ¬¡æ€§å®Œæˆæ•´ä¸ªå°è¯´
- ç¡®ä¿æ¯ä¸ªç« èŠ‚çš„è´¨é‡

### 2. æ¸…æ™°çš„å·¥ä»¶

æ¯ä¸ªä¼šè¯ç•™ä¸‹æ¸…æ™°çš„å·¥ä»¶ï¼š
- è¿›åº¦æ–‡ä»¶è®°å½•å½“å‰çŠ¶æ€
- Gitæäº¤ä¿å­˜å†å²
- å®¡æŸ¥æŠ¥å‘Šæä¾›åé¦ˆ

### 3. ä¸Šä¸‹æ–‡ç®¡ç†

- è‡ªåŠ¨åŠ è½½å¿…è¦çš„ä¸Šä¸‹æ–‡
- ä¿æŒè§’è‰²å’Œæƒ…èŠ‚çš„ä¸€è‡´æ€§
- ç« èŠ‚ä¹‹é—´çš„è¿è´¯æ€§

### 4. è´¨é‡æ§åˆ¶

- å¤šç»´åº¦è´¨é‡è¯„ä¼°
- è‡ªåŠ¨ä¿®æ”¹æœºåˆ¶
- äººå·¥å¯ä»‹å…¥å®¡æŸ¥

### 5. å‹å¥½ç•Œé¢

- **Web UI** - ç°ä»£åŒ–çš„ Streamlit ç•Œé¢ï¼Œæ— éœ€ç¼–ç¨‹å³å¯ä½¿ç”¨
- **å¯è§†åŒ–è¿›åº¦** - å®æ—¶å›¾è¡¨å±•ç¤ºé¡¹ç›®è¿›åº¦å’Œç« èŠ‚çŠ¶æ€
- **ä¸€é”®æ“ä½œ** - ç®€åŒ–çš„å°è¯´ç”Ÿæˆæµç¨‹

## æ‰©å±•å¼€å‘

### é›†æˆçœŸå®LLM

å½“å‰ä½¿ç”¨æ¨¡æ‹ŸLLMå®¢æˆ·ç«¯ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›¿æ¢ä¸ºçœŸå®APIï¼š

```python
# åœ¨ novel_generator.py ä¸­
class RealLLMClient:
    def __init__(self, api_key):
        self.client = anthropic.Anthropic(api_key=api_key)
    
    def generate(self, prompt, **kwargs):
        response = self.client.messages.create(
            model="claude-3-5-sonnet-20241022",
            max_tokens=4000,
            messages=[{"role": "user", "content": prompt}]
        )
        return response.content[0].text
```

### è‡ªå®šä¹‰ä»£ç†

å¯ä»¥ç»§æ‰¿åŸºç±»åˆ›å»ºè‡ªå®šä¹‰ä»£ç†ï¼š

```python
from novel_generator.agents.writer_agent import WriterAgent

class CustomWriterAgent(WriterAgent):
    def _write_chapter(self, chapter_number, context):
        # è‡ªå®šä¹‰å†™ä½œé€»è¾‘
        pass
```

### æ·»åŠ æ–°åŠŸèƒ½

- **ç¿»è¯‘ä»£ç†** - å°†å°è¯´ç¿»è¯‘æˆå…¶ä»–è¯­è¨€
- **å°é¢ç”Ÿæˆ** - è‡ªåŠ¨ç”Ÿæˆå°è¯´å°é¢
- **éŸ³é¢‘ç”Ÿæˆ** - å°†å°è¯´è½¬æ¢ä¸ºæœ‰å£°ä¹¦
- **Web UI å¢å¼º** - æ·»åŠ ä¸»é¢˜å®šåˆ¶ã€åä½œåŠŸèƒ½ã€äº‘åŒæ­¥

## æœ€ä½³å®è·µ

### 1. é¡¹ç›®è§„åˆ’

- å…ˆåˆ›å»ºè¯¦ç»†çš„é…ç½®æ–‡ä»¶
- æ˜ç¡®å°è¯´ç±»å‹å’Œé£æ ¼
- åˆç†è§„åˆ’ç« èŠ‚æ•°é‡

### 2. è´¨é‡æ§åˆ¶

- è®¾ç½®åˆé€‚çš„è´¨é‡åˆ†æ•°é˜ˆå€¼
- å®šæœŸæŸ¥çœ‹å®¡æŸ¥æŠ¥å‘Š
- å¿…è¦æ—¶äººå·¥ä»‹å…¥ä¿®æ”¹

### 3. è¿­ä»£ä¼˜åŒ–

- æ ¹æ®ç”Ÿæˆç»“æœè°ƒæ•´é…ç½®
- ä¼˜åŒ–è§’è‰²è®¾å®šå’Œå¤§çº²
- æ”¹è¿›å†™ä½œé£æ ¼æŒ‡å—

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šç”Ÿæˆå†…å®¹è´¨é‡ä¸é«˜

**è§£å†³æ–¹æ¡ˆï¼š**
- æé«˜ `min_chapter_quality_score`
- å¢åŠ  `max_revision_attempts`
- ä¼˜åŒ– `description` æä¾›æ›´è¯¦ç»†çš„æŒ‡å¯¼

### é—®é¢˜ï¼šç« èŠ‚ä¹‹é—´ä¸è¿è´¯

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥å¤§çº²çš„ç« èŠ‚è§„åˆ’
- ç¡®ä¿å‰ä¸€ç« èŠ‚å·²æ­£ç¡®ä¿å­˜
- å¢åŠ ä¸Šä¸‹æ–‡åŠ è½½çš„èŒƒå›´

### é—®é¢˜ï¼šè§’è‰²ä¸ä¸€è‡´

**è§£å†³æ–¹æ¡ˆï¼š**
- å®Œå–„è§’è‰²è®¾å®š
- å¢åŠ è§’è‰²ä¸€è‡´æ€§æ£€æŸ¥
- åœ¨å†™ä½œæç¤ºä¸­å¼ºè°ƒè§’è‰²ç‰¹å¾

## æŠ€æœ¯ç»†èŠ‚

### è¿›åº¦æ–‡ä»¶æ ¼å¼

```json
{
  "title": "å°è¯´æ ‡é¢˜",
  "genre": "ç±»å‹",
  "total_chapters": 10,
  "completed_chapters": 5,
  "current_chapter": 6,
  "total_word_count": 15000,
  "status": "writing",
  "chapters": [
    {
      "chapter_number": 1,
      "title": "ç¬¬ä¸€ç« æ ‡é¢˜",
      "status": "completed",
      "word_count": 3000,
      "quality_score": 8.5
    }
  ]
}
```

### ç« èŠ‚åˆ—è¡¨æ ¼å¼

```json
[
  {
    "chapter_number": 1,
    "title": "ç« èŠ‚æ ‡é¢˜",
    "summary": "ç« èŠ‚æ¦‚è¦",
    "key_plot_points": ["æƒ…èŠ‚ç‚¹1", "æƒ…èŠ‚ç‚¹2"],
    "characters_involved": ["è§’è‰²1", "è§’è‰²2"],
    "word_count_target": 3000,
    "status": "completed"
  }
]
```

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## è®¸å¯è¯

MIT License

## è‡´è°¢

æœ¬ç³»ç»ŸåŸºäº Anthropic çš„ç ”ç©¶æˆæœï¼š
- [Effective harnesses for long-running agents](https://www.anthropic.com/engineering/effective-harnesses-for-long-running-agents)
- [Claude 4 Prompting Guide](https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/multi-context-window-workflows)
